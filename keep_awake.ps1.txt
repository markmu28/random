# Create a shell object to simulate keystrokes
$wsh = New-Object -ComObject WScript.Shell

Clear-Host
Write-Host "--- Windows Keep Awake Script (Randomized) ---" -ForegroundColor Cyan
Write-Host "Status: Active" -ForegroundColor Green
Write-Host "Action: Pressing virtual 'F15' key at random intervals."
Write-Host "Window: Minimize this window to keep running."
Write-Host "Stop: Close this window." -ForegroundColor Yellow

while ($true) {
    # Send F15 key (This key doesn't exist on most keyboards and does nothing,
    # but Windows registers it as activity)
    $wsh.SendKeys("{F15}")
    
    # Generate a random sleep time between 2 and 60 seconds
    $randomSeconds = Get-Random -Minimum 2 -Maximum 61
    
    # Optional: Log the next press time
    # Write-Host "Activity sent. Next press in $randomSeconds seconds." -ForegroundColor DarkGray

    # Wait for the random duration
    Start-Sleep -Seconds $randomSeconds
}